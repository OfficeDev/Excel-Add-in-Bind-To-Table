<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/04f9c26e-88fd-4dfd-b715-9733d17420b6Combined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Apps for Office: Bind an app to a table inserted into Excel or Word</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Apps for Office: Bind an app to a table inserted into Excel or Word</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Word 2013, Excel 2013, apps for Office
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            App model, apps for Office, Binding
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">3/25/2014</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/Apps-for-Office-Bind-an-bc363880">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<p id="header"><span class="label">Summary:</span> Demonstrates how to use the JavaScript API for Office to bind an app to a named table in Microsoft Excel 2013 or Microsoft Word 2013, extract data from the table, react to events in the table, and set data
 back into the table.</p>
<div id="mainSection">
<div id="mainBody">
<h1 class="heading">Description</h1>
<div id="sectionSection0" class="section">
<p>This app code sample gets binds a Stock Ticker app to a named table that is included in the solution project. The code that uses the Binding object of the JavaScript API for Office is included in the UpdateTable.js file of the solution. The code sample binds
 to a table named &quot;Stocks&quot; on the worksheet labeled &quot;Sheet1.&quot;</p>
<p>The sample demonstrates how to establish a binding between a region in an Office file&mdash;a named table, in this case&mdash;and an app for Office. Once the binding has been established, the app adds a handler to the
<span><span class="keyword">BindingDataChanged</span></span> event of the binding. When the event handler executes, the app retrieves a selection of the data from the table. It then removes the event handler from the binding, updates the table, and then adds
 the event handler back to the binding.</p>
<p>For more information about the JavaScript API for Office and working with bindings, see
<a href="http://msdn.microsoft.com/en-us/library/office/apps/fp123511.aspx" >
Binding to regions in a document or spreadsheet</a>.</p>
</div>
<h1 class="heading">Prerequisites</h1>
<div id="sectionSection1" class="section">
<div>This sample requires the following:</div>
<ul>
<li>
<div>Word 2013 or Excel 2013</div>
</li><li>
<div>Visual Studio 2012 and Office Developer Tools for Visual Studio 2012</div>
</li><li>
<div>Internet Explorer 9 or Internet Explorer 10.</div>
</li></ul>
</div>
<h1 class="heading">Key components</h1>
<div id="sectionSection2" class="section">
<div>The Stock Ticker sample app contains the following:</div>
<ul>
<li>
<div><strong>CodeSample_BindingAppToXLTable</strong> project.</div>
<ul>
<li>
<div><strong>CodeSample_BindingAppToXLTable.xml</strong> manifest file</div>
</li><li>
<div><strong>Book1.xlsx</strong> file that contains a table named &quot;Stocks&quot; on a spreadsheet named &quot;Sheet1.&quot;</div>
</li></ul>
</li><li>
<div><strong>CodeSample_BindingAppToXLTableWeb</strong> project</div>
<ul>
<li>
<div><strong>Home.html</strong> file, which contains the HTML control for the app's user interface.</div>
</li><li>
<div><strong>Home.js</strong> file, which contains the event handler for the <span>
<span class="keyword">Office.initialize</span></span> event of the app.</div>
</li><li>
<div><strong>UpdateTable.js</strong> file, which contains the self-executing anonymous function that creates the binding, adds an event handler to the binding, and contains all of the methods for getting and setting data from the binding.</div>
</li></ul>
</li></ul>
</div>
<h1 class="heading">Configure the sample</h1>
<div id="sectionSection3" class="section">
<p>To configure the Stock Ticker, set the <span class="ui">StartAction</span> property of the
<strong>CodeSample_BindingAppToTable</strong> project to 'Book1.xslx'.</p>
</div>
<h1 class="heading">Build the sample</h1>
<div id="sectionSection4" class="section">
<p>Choose the F5 key to build and deploy the app.</p>
</div>
<h1 class="heading">Run and test the sample</h1>
<div id="sectionSection5" class="section">
<ol>
<li>
<div>Choose the F5 key to build and deploy the app.</div>
</li><li>
<div>Insert the app into the Book1.xlsx file when you debug the sample (<span class="ui">Insert</span> tab,
<span class="ui">Apps for Office</span> button).</div>
<div class="alert">
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<th align="left"><strong>Note</strong></th>
</tr>
<tr>
<td>
<div>If you save the workbook while debugging, the app is persisted in the workbook. If you do so, you won't have to reinsert the app into the workbook during future debugging sessions.</div>
</td>
</tr>
</tbody>
</table>
</div>
</li><li>
<div>In the app, choose <span class="ui">Set binding</span>.</div>
</li><li>
<div>In the table on Book1.xlsx, make a change to one of the values in the first column in the right.</div>
</li></ol>
</div>
<h1 class="heading">Troubleshooting</h1>
<div id="sectionSection6" class="section">
<p>If the app fails to install, ensure that the XML in your <strong>AppManifest.xml</strong> file parses correctly.</p>
<p>If you change the code in the <span class="code">StockTicker.getStockQuotes</span> method to call an external stock quote service, be aware that cross-domain scripting restrictions still apply.</p>
<p>If the app generates errors whenever you try to update the table, ensure that you have entered correct values for the
<span class="code">tableName</span> and <span class="code">bindingName</span> variables in the
<strong>UpdateTable.js</strong> file.</p>
</div>
<h1 class="heading">Change log</h1>
<div id="sectionSection7" class="section">
<p>First release. March 8, 2013.</p>
</div>
<h1 class="heading">Related content</h1>
<div id="sectionSection8" class="section">
<ul>
<li>
<div><a href="http://msdn.microsoft.com/en-us/library/office/apps/fp123511.aspx" >Binding to regions in a document or spreadsheet</a></div>
</li><li>
<div><a href="http://msdn.microsoft.com/en-us/library/office/apps/fp160966.aspx" >Bindings object</a></div>
</li><li>
<div><a href="http://msdn.microsoft.com/en-us/library/office/apps/fp161045.aspx" >Binding object</a></div>
</li></ul>
</div>
</div>
</div>

</div>


    </div>
</body>
</html>
